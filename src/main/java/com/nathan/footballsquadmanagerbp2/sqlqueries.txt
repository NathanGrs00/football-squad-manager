CREATE DATABASE f_squad_manager;

CREATE TABLE `f_squad_manager`.`user` (`id` INT(11) NOT NULL AUTO_INCREMENT , `name` VARCHAR(15) UNIQUE NOT NULL , `password` VARCHAR(15) NOT NULL , `role` VARCHAR(16) NULL , PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`formation` (`id` INT(2) NOT NULL AUTO_INCREMENT , `name` VARCHAR(30) NOT NULL , `abbreviation` VARCHAR(3) NOT NULL , PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`selection` (`id` INT(11) NOT NULL AUTO_INCREMENT , `name` VARCHAR(9) NULL , `date` DATE NOT NULL , `user_id` INT(11) NOT NULL , `formation_id` INT(2) NULL PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`position` (`id` INT(2) NOT NULL AUTO_INCREMENT , `name` VARCHAR(25) NOT NULL , `abbreviation` VARCHAR(3) NOT NULL , PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`player` (`id` INT(11) NOT NULL AUTO_INCREMENT , `first_name` VARCHAR(15) NOT NULL , `last_name` VARCHAR(20) NOT NULL , `age` INT(2) NOT NULL , `pref_foot` VARCHAR(1) NOT NULL , `status` VARCHAR(15) NOT NULL , PRIMARY KEY (`id`)) ENGINE = InnoDB;

CREATE TABLE `f_squad_manager`.`player_position` (`player_id` INT(11) NOT NULL , `position_id` INT(2) NOT NULL , `proficiency` INT(1) NOT NULL DEFAULT '0' ) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`formation_position` (`formation_id` INT(2) NOT NULL , `position_id` INT(2) NOT NULL ) ENGINE = InnoDB;
CREATE TABLE `f_squad_manager`.`selection_details` (`selection_id` INT(11) NOT NULL , `player_id` INT(11) NOT NULL , `position_id` INT(2) NOT NULL ) ENGINE = InnoDB;

ALTER TABLE formation_position
ADD CONSTRAINT fk_formation_id FOREIGN KEY (formation_id) REFERENCES formation(id),
ADD CONSTRAINT fk_position_id FOREIGN KEY (position_id) REFERENCES position(id);

ALTER TABLE player_position
ADD CONSTRAINT fk_player_id FOREIGN KEY (player_id) REFERENCES player(id),
ADD CONSTRAINT fk_pposition_id FOREIGN KEY (position_id) REFERENCES `position`(id);

ALTER TABLE selection_details
ADD CONSTRAINT fk_splayer_id FOREIGN KEY (player_id) REFERENCES player(id),
ADD CONSTRAINT fk_sposition_id FOREIGN KEY (position_id) REFERENCES `position`(id),
ADD CONSTRAINT fk_sselection_id FOREIGN KEY (selection_id) REFERENCES selection(id);

ALTER TABLE `selection`
ADD CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES `user`(id);


INSERT INTO formation (name)
VALUES ("4-4-2"),
        ("4-3-3"),
        ("3-5-2"),
        ("5-4-1"),
        ("4-2-3-1");

INSERT INTO position (name, abbreviation)
VALUES ("Goalkeeper", "GK"),
        ("Leftback", "LB"),
		("Rightback","RB"),
        ("Centerback","CB"),
        ("Left Centerback","LCB"),
        ("Right Centerback","RCB"),
        ("Left Wingback","LWB"),
        ("Right Wingback","RWB"),
        ("Center Defensive Midfielder","CDM"),
        ("Left Defensive Midfielder","LDM"),
        ("Right Defensive Midfielder","RDM"),
        ("Left Midfielder","LM"),
        ("Right Midfielder","RM"),
        ("Center Midfielder","CM"),
        ("Left Center Midfielder","LCM"),
        ("Right Center Midfielder","RCM"),
        ("Attacking Midfielder","AMC"),
        ("Left Attacking Midfielder","AML"),
        ("Right Attacking Midfielder","AMR"),
        ("Left Winger","LW"),
        ("Right Winger","RW"),
        ("Striker","ST"),
        ("Left Forward","LF"),
        ("Right Forward","RF");

INSERT INTO formation_position (formation_id, position_id)
VALUES
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "LCB")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "RCB")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "LB")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "RB")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "LCM")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "RCM")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "AMC")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "LW")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "RW")),
    ((SELECT id FROM formation WHERE name = "4-3-3"), (SELECT id FROM position WHERE abbreviation = "ST")),

    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "LCB")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "RCB")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "LB")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "RB")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "LCM")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "RCM")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "LM")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "RM")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "LF")),
    ((SELECT id FROM formation WHERE name = "4-4-2"), (SELECT id FROM position WHERE abbreviation = "RF")),

    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "CB")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "LCB")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "RCB")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "LDM")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "RDM")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "CM")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "LM")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "RM")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "LF")),
    ((SELECT id FROM formation WHERE name = "3-5-2"), (SELECT id FROM position WHERE abbreviation = "RF")),

    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "CB")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "LCB")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "RCB")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "LWB")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "RWB")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "LCM")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "RCM")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "LM")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "RM")),
    ((SELECT id FROM formation WHERE name = "5-4-1"), (SELECT id FROM position WHERE abbreviation = "ST")),

    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "LCB")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "RCB")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "LB")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "RB")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "LDM")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "RDM")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "AMC")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "AML")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "AMR")),
    ((SELECT id FROM formation WHERE name = "4-2-3-1"), (SELECT id FROM position WHERE abbreviation = "ST"));

